<div class="top-container">

	 <!-- Nav bar -->
	<div class="fixed-top">
		<nav class="navbar-container navbar-expand-md">
			<div class="top-navbar-left">
				<div>
					<ul class="navbar-nav">
						<li class="nav-item nav-item-font py-2">
							<button class="nav-link nav-button text-white ml-1" (click)="switchHideMenu()"><i class="fa fa-bars"></i></button>
						</li>
						<li class="nav-item nav-item-font py-2 d-none d-md-block">
							<button class="nav-link nav-button text-white ml-1" (click)="toHome()"><i class="fa fa-home"></i></button>
						</li>
						<li class="nav-item nav-item-font py-2 nav-search d-none d-md-block">
							<span class="search_icon">
								<i class="fa text-white mr-2 fa-search"></i>
							</span>
							<form class="form-inline">
								<input class="form-control mr-sm-2" type="search" placeholder="Find">
							</form>
						</li>
					</ul>
					
				</div>
			</div>
			<ul class="navbar-nav top-navbar-right">
				<li class="nav-item nav-item-font py-2">
					<button class="nav-link nav-button top-right-part text-white mr-2" (click)="openAddTaskModal()"><i class="fa top-right-part fa-plus"></i> </button>
				</li>
				<li class="nav-item nav-item-font py-2 ">
					<button class="nav-link nav-button top-right-part text-white mr-2" href="#">
					<i class="fa top-right-part fa-line-chart" id="status"></i></button>
				</li>
				<li class="nav-item nav-item-font py-2 ">
					<button class="nav-link nav-button top-right-part text-white mr-2" href="#"><i class="fa top-right-part fa-bell"></i> </button>
				</li>
				<li class="nav-item nav-item-font py-2 ">
					<button class="nav-link nav-button top-right-part text-white mr-2" href="#"><i class="fa top-right-part fa-cog"></i></button>
				</li>
			</ul>
		</nav>
	</div>

	<!-- Left navigation -->
	<div class="container-fluid">
		<div class="row-container">
			<div class="left-nav-container" [class.visibleLeftNav]="!hideMenu" [class.hiddenLeftNav]="hideMenu">
				<div class="left-nav">
						<ul class="top_filters">
							<li class="filter" id="filter_inbox">
								<button class="filter_button" (click)="toInbox()">
									<span class="item_icon">
										<i class="fa text-primary mr-2 fa-inbox"></i>
									</span>
									<span class="item_content">
										Inbox
										<small class="item_counter">{{ tree.getNumOfUncompletedTasksInInbox() }}</small>
									</span>
								</button>
							</li>
							<li class="filter" id="filter_today">
								<button class="filter_button" (click)="toHome()">
									<span class="item_icon">
										<i class="fa mr-2 text-success fa-calendar-minus-o"></i>
									</span>
									<span class="item_content">
										Today
										<small class="item_counter">{{ tree.getNumOfUncompletedTasksToday() }}</small>
									</span>
								</button>
							</li>
							<li class="filter" id="filter_today">
								<button class="filter_button" (click)="toUpcoming()">
									<span class="item_icon">
										<i class="fa text-warning mr-2 fa-calendar"></i>
									</span>
									<span class="item_content">
										Upcoming
									</span>
								</button>
							</li>
						</ul>


						<div class="expansion_panel">
							<div class="expansion_panel__header" style="top: 372px;">
								<button type="button" class="expansion_panel__toggle" (click)="switchProjectCollapse()">
									<div class="expansion_panel__toggle_icon">
										<i class="fa mx-2 text-muted fa-chevron-right"  [class.rotated]="!tree.projectCollapsed"></i>
									</div>
									Projects
								</button>
								<div class="expansion_panel__actions">
									<button type="button" class="adder_icon" (click)="openProjectModal()">
										<i class="fa fa-plus"></i>
									</button>
								</div>
							</div>
							<div class="projects" style="min-height: 0px;" [class.hidden]="tree.projectCollapsed">
								<div class="projects_list_container">
									<ul class="items generic_left_list projects_list">
										<li *ngIf="draggedId" [dndDropzone]="[]" (dndDrop)="onDropFirst($event)" class="drag-zone drag-list-item">
											
										</li>
										<ng-container *ngFor="let project of tree.getProjects()">
											<li class="project_list_item" [class.hiddenProject]="isParentCollapsed(project.parentList) || isParentDragged(project.parentList)" 
												[dndDraggable]="project.id" (dndStart)="onDragStart(project.id)" (dndEnd)="onDragEnd()">
												<span class="indent" *ngFor="let e of [].constructor(project.indent)"></span>
												<span class="left_actions">
													<button type="button" class="handle" dndHandle>
														<i class="fa fa-ellipsis-v"></i>
														<i class="fa fa-ellipsis-v"></i>
													</button>
													<button type="button" class="arrow" *ngIf="project.hasChildren" (click)="collapseProject(project.id)">
														<i class="fa fa-chevron-right" [class.rotated]="!isProjectCollapsed(project.id)"></i>
													</button>
												</span>
												<button class="text" (click)="toProject(project.id)">
													<div class="div-color" [style]="'color: ' + project.color +';'"></div>
													{{project.name}}
													<div class="counter_count">{{tree.getNumOfUncompletedTasksByProject(project.id)}}</div>
												</button>
												
												<button type="button" #contextMenuButton class="icon_more" (click)="openContextProjectMenu($event, project.id)">
													<i class="fa fa-ellipsis-h"></i>
												</button>
											</li>
											<li *ngIf="draggedId && !hideDropZone(project)" class="drag_list_item">
												<span class="indent" *ngFor="let e of [].constructor(project.hasChildren && !project.collapsed ? project.indent+1 : project.indent)"></span>
												<span class="indent drag-zone" [dndDropzone]="[]" (dndDrop)="onDrop($event, project)" *ngIf="!project.hasChildren || project.collapsed"></span>
												<span [dndDropzone]="[]" (dndDrop)="onDrop($event, project, true)" class="drag-zone last-drag-zone"></span>
											</li>
										</ng-container>
									</ul>
									<button type="button" class="plus_add_button" (click)="openProjectModal()">
										<span class="icon_add">
											<i class="fa fa-plus"></i>
										</span>
										Add project
									</button>
								</div>
							</div>
						</div>

						<div class="expansion_panel">
							<div class="expansion_panel__header" style="top: 372px;">
								<button type="button" class="expansion_panel__toggle" (click)="switchFilterCollapse()">
									<div class="expansion_panel__toggle_icon">
										<i class="fa mx-2 text-muted fa-chevron-right"  [class.rotated]="!collapseFilters"></i>
									</div>
									Filters
								</button>
								<div class="expansion_panel__actions">
									<button type="button" class="adder_icon">
										<i class="fa fa-plus"></i>
									</button>
								</div>
							</div>
						</div>

						<div class="expansion_panel">
							<div class="expansion_panel__header" style="top: 372px;">
								<button type="button" class="expansion_panel__toggle" (click)="switchLabelCollapse()">
									<div class="expansion_panel__toggle_icon">
										<i class="fa mx-2 text-muted fa-chevron-right"  [class.rotated]="!collapseLabels"></i>
									</div>
									Labels
								</button>
								<div class="expansion_panel__actions">
									<button type="button" class="adder_icon">
										<i class="fa fa-plus"></i>
									</button>
								</div>
							</div>
						</div>
					
				</div>
			</div>
			<div class="main-container">
				<div class="tab-content">
					<router-outlet></router-outlet>
				</div>
			</div>
		</div>

	</div>

</div>

<app-project-dialog *ngIf="displayProjectModal" (closeEvent)="closeProjectModal()" [project]="projectForModalWindow" [after]="addAfter" [before]="addBefore"> </app-project-dialog>
<app-task-dialog *ngIf="displayAddTask" (closeEvent)="closeAddTaskModal()"></app-task-dialog>

<div class="ist-menu context" [class.hidden-context-menu]="!showContextProjectMenu" [ngStyle]="{'left.px': projectContextMenuX, 'top.px': projectContextMenuY}">
	<ul class="context-menu-project" #projectContext>
		<li class="context-menu-project-item">
			<button (click)="openProjectModalAbove()">
				<span class="menu_icon">
					<i class="fa fa-arrow-up"></i>
				</span>
				<div class="menu_label">Add project above</div>
			</button>
		</li>
		<li class="context-menu-project-item">
			<button (click)="openProjectModalBelow()">
				<span class="menu_icon">
					<i class="fa fa-arrow-down"></i>
				</span>
				<div class="menu_label">Add project below</div>
			</button>
		</li>
		<li class="context-menu-project-item">
			<button (click)="openProjectModalWithProject()">
				<span class="menu_icon">
					<i class="fa fa-edit"></i>
				</span>
				<div class="menu_label">Edit project</div>
			</button>
		</li>
		<li class="context-menu-project-item">
			<button (click)="updateProjectFav()" *ngIf="contextProjectMenu">
				<span class="menu_icon">
					<i class="fa fa-heart-o" *ngIf="!contextProjectMenu.favorite"></i>
					<i class="fa fa-heart" *ngIf="contextProjectMenu.favorite"></i>
				</span>
				<div class="menu_label">{{!contextProjectMenu.favorite ? "Add to favorites" : "Remove from favorites"}}</div>
			</button>
		</li>
		<li class="context-menu-project-item">
			<button (click)="duplicateProject()" >
				<span class="menu_icon">
					<i class="fa fa-clone"></i>
				</span>
				<div class="menu_label">Duplicate</div>
			</button>
		</li>
		<li class="context-menu-project-item">
			<button (click)="deleteProject()">
				<span class="menu_icon">
					<i class="fa fa-trash-o"></i>
				</span>
				<div class="menu_label">Delete project</div>
			</button>
		</li>
	</ul>
</div>